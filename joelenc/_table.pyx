# cython: language_level=3

cdef list sb_table = [
#     0     1    2      3     4    5     6     7      8    9     A      B    C     D     E     F
    0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
    0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
    0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
    0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
    0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
    0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
    0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
    0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
    0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
    0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
    0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
    0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
    0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
    0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
    0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
    0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
]

cdef list rsb_table = [
    0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb,
    0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb,
    0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e,
    0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25,
    0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92,
    0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84,
    0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06,
    0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b,
    0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73,
    0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e,
    0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b,
    0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4,
    0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f,
    0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef,
    0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61,
    0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d
]

cdef list chr_table = [
    'f7', 'a4', '96', 'f3', 'b9', 'db', 'cd', 'd2', 'd4', '46', 'd9', '43', '99', 'c4', '6a', '3b', 
    '0e', 'ed', 'eb', '18', '78', '88', '3c', '47', 'ba', 'a0', '8d', 'c3', 'af', '7b', '72', 'c0', 
    'fc', 'e5', '74', 'ec', 'e4', '03', 'b2', '91', '67', 'ae', '35', 'be', '89', '13', '4d', '6e', 
    '11', '21', 'b4', '57', 'e6', 'b5', '15', '09', 'c5', '4b', '59', '2f', '7c', '08', '81', '5e', 
    '70', '7d', '0b', '1b', 'ab', 'de', '9f', '76', '8f', 'fb', '77', '95', '9e', 'a7', 'e3', 'b8', 
    '26', '55', '0d', '62', 'f4', '98', 'dc', '22', 'e2', '7e', 'ff', '8e', 'a9', 'e8', '3a', '14', 
    '58', 'ee', '19', 'c8', 'ce', '4e', '2c', '2d', '23', '25', 'cb', 'cc', 'd0', '84', 'b1', 'c2', 
    '48', '5a', '4c', '10', '32', '53', '17', 'aa', '3d', '9a', 'd3', '49', '80', 'a5', '56', '31', 
    'fd', '1c', '2b', 'e7', 'da', 'f6', 'c1', '01', '3f', 'bb', 'f0', 'd6', 'c7', '5b', '6d', 'f2', 
    '5f', '97', 'e9', '0f', '5d', '1f', '45', '63', '07', 'df', 'ca', '85', '79', 'bf', '2e', '06', 
    '16', '04', '34', '73', '24', '02', '7a', 'a1', '28', '52', '9b', 'a3', '41', 'b7', '40', '94', 
    '6c', '83', '50', '61', 'b6', '54', '4a', '00', '69', '6f', '90', '8b', 'f5', '33', 'f9', '8a', 
    '3e', 'd8', 'fa', '39', 'f1', 'a2', '7f', '44', '75', '0c', 'a6', 'c6', 'ea', 'b0', '36', 'd5', 
    'bd', '5c', '65', '93', 'ac', 'bc', '51', '71', 'a8', '2a', 'ef', 'e1', '0a', '12', 'cf', '60', 
    'f8', '1e', '82', '86', 'e0', '20', 'b3', '9c', 'c9', '30', '42', '68', '37', 'd7', '4f', '8c', 
    'ad', 'fe', 'dd', '92', '64', 'd1', '66', '6b', '05', '27', '38', '9d', '1a', '1d', '29', '87'
]

cdef dict rchr_table = {
    'f7': 0x63, 'a4': 0x7c, '96': 0x77, 'f3': 0x7b, 'b9': 0xf2, 'db': 0x6b, 'cd': 0x6f, 'd2': 0xc5, 'd4': 0x30, '46': 0x01, 'd9': 0x67, '43': 0x2b, '99': 0xfe, 'c4': 0xd7, '6a': 0xab, '3b': 0x76, 
    '0e': 0xca, 'ed': 0x82, 'eb': 0xc9, '18': 0x7d, '78': 0xfa, '88': 0x59, '3c': 0x47, '47': 0xf0, 'ba': 0xad, 'a0': 0xd4, '8d': 0xa2, 'c3': 0xaf, 'af': 0x9c, '7b': 0xa4, '72': 0x72, 'c0': 0xc0,
    'fc': 0xb7, 'e5': 0xfd, '74': 0x93, 'ec': 0x26, 'e4': 0x36, '03': 0x3f, 'b2': 0xf7, '91': 0xcc, '67': 0x34, 'ae': 0xa5, '35': 0xe5, 'be': 0xf1, '89': 0x71, '13': 0xd8, '4d': 0x31, '6e': 0x15,
    '11': 0x04, '21': 0xc7, 'b4': 0x23, '57': 0xc3, 'e6': 0x18, 'b5': 0x96, '15': 0x05, '09': 0x9a, 'c5': 0x07, '4b': 0x12, '59': 0x80, '2f': 0xe2, '7c': 0xeb, '08': 0x27, '81': 0xb2, '5e': 0x75,
    '70': 0x09, '7d': 0x83, '0b': 0x2c, '1b': 0x1a, 'ab': 0x1b, 'de': 0x6e, '9f': 0x5a, '76': 0xa0, '8f': 0x52, 'fb': 0x3b, '77': 0xd6, '95': 0xb3, '9e': 0x29, 'a7': 0xe3, 'e3': 0x2f, 'b8': 0x84,
    '26': 0x53, '55': 0xd1, '0d': 0x00, '62': 0xed, 'f4': 0x20, '98': 0xfc, 'dc': 0xb1, '22': 0x5b, 'e2': 0x6a, '7e': 0xcb, 'ff': 0xbe, '8e': 0x39, 'a9': 0x4a, 'e8': 0x4c, '3a': 0x58, '14': 0xcf,
    '58': 0xd0, 'ee': 0xef, '19': 0xaa, 'c8': 0xfb, 'ce': 0x43, '4e': 0x4d, '2c': 0x33, '2d': 0x85, '23': 0x45, '25': 0xf9, 'cb': 0x02, 'cc': 0x7f, 'd0': 0x50, '84': 0x3c, 'b1': 0x9f, 'c2': 0xa8,
    '48': 0x51, '5a': 0xa3, '4c': 0x40, '10': 0x8f, '32': 0x92, '53': 0x9d, '17': 0x38, 'aa': 0xf5, '3d': 0xbc, '9a': 0xb6, 'd3': 0xda, '49': 0x21, '80': 0x10, 'a5': 0xff, '56': 0xf3, '31': 0xd2,
    'fd': 0xcd, '1c': 0x0c, '2b': 0x13, 'e7': 0xec, 'da': 0x5f, 'f6': 0x97, 'c1': 0x44, '01': 0x17, '3f': 0xc4, 'bb': 0xa7, 'f0': 0x7e, 'd6': 0x3d, 'c7': 0x64, '5b': 0x5d, '6d': 0x19, 'f2': 0x73,
    '5f': 0x60, '97': 0x81, 'e9': 0x4f, '0f': 0xdc, '5d': 0x22, '1f': 0x2a, '45': 0x90, '63': 0x88, '07': 0x46, 'df': 0xee, 'ca': 0xb8, '85': 0x14, '79': 0xde, 'bf': 0x5e, '2e': 0x0b, '06': 0xdb,
    '16': 0xe0, '04': 0x32, '34': 0x3a, '73': 0x0a, '24': 0x49, '02': 0x06, '7a': 0x24, 'a1': 0x5c, '28': 0xc2, '52': 0xd3, '9b': 0xac, 'a3': 0x62, '41': 0x91, 'b7': 0x95, '40': 0xe4, '94': 0x79,
    '6c': 0xe7, '83': 0xc8, '50': 0x37, '61': 0x6d, 'b6': 0x8d, '54': 0xd5, '4a': 0x4e, '00': 0xa9, '69': 0x6c, '6f': 0x56, '90': 0xf4, '8b': 0xea, 'f5': 0x65, '33': 0x7a, 'f9': 0xae, '8a': 0x08,
    '3e': 0xba, 'd8': 0x78, 'fa': 0x25, '39': 0x2e, 'f1': 0x1c, 'a2': 0xa6, '7f': 0xb4, '44': 0xc6, '75': 0xe8, '0c': 0xdd, 'a6': 0x74, 'c6': 0x1f, 'ea': 0x4b, 'b0': 0xbd, '36': 0x8b, 'd5': 0x8a,
    'bd': 0x70, '5c': 0x3e, '65': 0xb5, '93': 0x66, 'ac': 0x48, 'bc': 0x03, '51': 0xf6, '71': 0x0e, 'a8': 0x61, '2a': 0x35, 'ef': 0x57, 'e1': 0xb9, '0a': 0x86, '12': 0xc1, 'cf': 0x1d, '60': 0x9e,
    'f8': 0xe1, '1e': 0xf8, '82': 0x98, '86': 0x11, 'e0': 0x69, '20': 0xd9, 'b3': 0x8e, '9c': 0x94, 'c9': 0x9b, '30': 0x1e, '42': 0x87, '68': 0xe9, '37': 0xce, 'd7': 0x55, '4f': 0x28, '8c': 0xdf,
    'ad': 0x8c, 'fe': 0xa1, 'dd': 0x89, '92': 0x0d, '64': 0xbf, 'd1': 0xe6, '66': 0x42, '6b': 0x68, '05': 0x41, '27': 0x99, '38': 0x2d, '9d': 0x0f, '1a': 0xb0, '1d': 0x54, '29': 0xbb, '87': 0x16
}

cdef int subbyte_lookup(byte):
    return sb_table[byte >> 4]

cdef str char_lookup(byte):
    return chr_table[byte >> 4]

cdef int reverse_subbyte_lookup(byte):
    return rsb_table[byte >> 4]

cdef int reverse_char_lookup(str char):
    return rchr_table[char]